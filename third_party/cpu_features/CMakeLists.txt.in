cmake_minimum_required (VERSION 3.5)

project(cpu_features-download NONE)

include(ExternalProject)
ExternalProject_Add(cpu_features
    GIT_REPOSITORY    https://github.com/google/cpu_features.git
    GIT_TAG 339bfd32be1285877ff517cba8b82ce72e946afd
    SOURCE_DIR        "${CMAKE_CURRENT_BINARY_DIR}/cpu_features-src"
    BINARY_DIR        "${CMAKE_CURRENT_BINARY_DIR}/cpu_features-build"
    CMAKE_ARGS
        -DCMAKE_SYSTEM_NAME=${CMAKE_SYSTEM_NAME}
        -DCMAKE_SYSTEM_PROCESSOR=${CMAKE_SYSTEM_PROCESSOR}
        -DCMAKE_RC_COMPILER="${CMAKE_RC_COMPILER}"
        -DCMAKE_POLICY_DEFAULT_CMP0063=NEW
        -DCMAKE_C_VISIBILITY_PRESET=hidden
        -DCMAKE_POSITION_INDEPENDENT_CODE=ON
    INSTALL_COMMAND   ""
    TEST_COMMAND      ""
)
